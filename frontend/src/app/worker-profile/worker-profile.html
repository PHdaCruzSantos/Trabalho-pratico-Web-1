<div *ngIf="worker" class="min-h-screen bg-background-light dark:bg-background-dark pb-16 pt-20">

  <!-- Cover Image -->
  <div class="h-48 md:h-64 bg-gradient-to-r from-primary to-secondary relative overflow-hidden">
    <div class="absolute inset-0 bg-black/20"></div>
    <div class="absolute -bottom-10 -right-10 w-64 h-64 bg-white/10 rounded-full blur-3xl"></div>
    <div class="absolute top-10 left-10 w-32 h-32 bg-white/10 rounded-full blur-2xl"></div>
  </div>

  <div class="container mx-auto px-4 sm:px-6 lg:px-8 -mt-20 relative z-10">
    <div class="bg-surface-light dark:bg-surface-dark rounded-2xl shadow-xl border border-white/5 p-6 md:p-8">

      <!-- Profile Header -->
      <div class="flex flex-col md:flex-row gap-6 md:gap-8 items-start md:items-end">
        <div class="flex-shrink-0 relative">
          <div class="w-32 h-32 md:w-40 md:h-40 rounded-2xl bg-surface-light dark:bg-surface-dark p-1 shadow-lg">
            <img class="w-full h-full rounded-xl object-cover" src="https://i.pravatar.cc/150?u={{worker.user.id}}"
              [alt]="worker.user.name">
          </div>
          <div
            class="absolute -bottom-2 -right-2 bg-success text-white text-xs font-bold px-2 py-1 rounded-lg shadow-md border-2 border-surface-light dark:border-surface-dark">
            {{ 'PROFILE.AVAILABLE' | translate }}
          </div>
        </div>

        <div class="flex-grow w-full">
          <div class="flex flex-col md:flex-row justify-between items-start md:items-end gap-4">
            <div>
              <h1 class="text-3xl md:text-4xl font-display font-bold text-on-surface-light dark:text-on-surface-dark">{{
                worker.user.name }}</h1>
              <div class="flex items-center gap-2 mt-2 text-on-surface-light/70 dark:text-on-surface-dark/70">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4">
                  <path fill-rule="evenodd"
                    d="M9.69 18.933l.003.001C9.89 19.02 10 19 10 19s.11.02.308-.066l.002-.001.006-.003.018-.008a5.741 5.741 0 0 0 .281-.14c.186-.096.446-.24.757-.433.62-.384 1.445-.966 2.274-1.765C15.302 14.988 17 12.493 17 9A7 7 0 1 0 3 9c0 3.492 1.698 5.988 3.355 7.62.829.799 1.654 1.381 2.274 1.766.311.192.571.337.757.433.093.048.17.085.224.114.027.014.05.026.066.034a.754.754 0 0 0 .018.008l.006.003ZM10 11.25a2.25 2.25 0 1 0 0-4.5 2.25 2.25 0 0 0 0 4.5Z"
                    clip-rule="evenodd" />
                </svg>
                <span>{{ worker.location }}</span>
                <span class="mx-1">â€¢</span>
                <div class="flex items-center text-yellow-500">
                  <span class="font-bold mr-1">5.0</span>
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4">
                    <path fill-rule="evenodd"
                      d="M10.868 2.884c-.321-.772-1.415-.772-1.736 0l-1.83 4.401-4.753.381c-.833.067-1.171 1.107-.536 1.651l3.62 3.102-1.106 4.637c-.194.813.691 1.456 1.405 1.02L10 15.591l4.069 2.485c.713.436 1.598-.207 1.404-1.02l-1.106-4.637 3.62-3.102c.635-.544.297-1.584-.536-1.65l-4.752-.382-1.831-4.401Z"
                      clip-rule="evenodd" />
                  </svg>
                  <span class="text-on-surface-light/50 dark:text-on-surface-dark/50 ml-1 text-sm">({{
                    worker.reviews.length }} {{ 'PROFILE.REVIEWS_COUNT' | translate }})</span>
                </div>
              </div>
            </div>

            <div *ngIf="!isOwnProfile" class="flex items-center gap-3 w-full md:w-auto mt-4 md:mt-0">
              <button (click)="openRequestModal()"
                class="flex-1 md:flex-none px-6 py-3 bg-primary hover:bg-primary-dark text-white rounded-xl font-bold shadow-lg shadow-primary/30 transition-all duration-300 transform hover:-translate-y-0.5">
                {{ 'PROFILE.HIRE_NOW' | translate }}
              </button>
              <button
                class="p-3 bg-surface-light dark:bg-surface-dark border border-gray-200 dark:border-gray-700 text-on-surface-light dark:text-on-surface-dark rounded-xl hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors"
                [title]="'PROFILE.FAVORITE' | translate">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                  stroke="currentColor" class="w-6 h-6">
                  <path stroke-linecap="round" stroke-linejoin="round"
                    d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z" />
                </svg>
              </button>
            </div>
          </div>

          <div class="mt-6">
            <p class="text-on-surface-light/80 dark:text-on-surface-dark/80 leading-relaxed max-w-3xl">{{ worker.bio }}
            </p>
          </div>

          <div class="mt-6 flex flex-wrap gap-2">
            <span *ngFor="let category of worker.categories"
              class="px-3 py-1 rounded-lg bg-primary/10 text-primary text-sm font-medium border border-primary/20">
              {{ category.name }}
            </span>
          </div>
        </div>
      </div>

      <!-- Tabs -->
      <div class="mt-12 border-b border-gray-200 dark:border-gray-700">
        <nav class="flex space-x-8" aria-label="Tabs">
          <button (click)="activeTab = 'portfolio'" [class.text-primary]="activeTab === 'portfolio'"
            [class.border-primary]="activeTab === 'portfolio'"
            [class.text-on-surface-light/60]="activeTab !== 'portfolio'"
            [class.dark:text-on-surface-dark/60]="activeTab !== 'portfolio'"
            [class.border-transparent]="activeTab !== 'portfolio'"
            class="pb-4 px-1 border-b-2 font-medium text-lg transition-colors duration-200">
            {{ 'PROFILE.TABS.PORTFOLIO' | translate }}
          </button>
          <button (click)="activeTab = 'reviews'" [class.text-primary]="activeTab === 'reviews'"
            [class.border-primary]="activeTab === 'reviews'" [class.text-on-surface-light/60]="activeTab !== 'reviews'"
            [class.dark:text-on-surface-dark/60]="activeTab !== 'reviews'"
            [class.border-transparent]="activeTab !== 'reviews'"
            class="pb-4 px-1 border-b-2 font-medium text-lg transition-colors duration-200">
            {{ 'PROFILE.TABS.REVIEWS' | translate }} <span
              class="ml-1 text-sm bg-gray-100 dark:bg-gray-800 px-2 py-0.5 rounded-full">{{ worker.reviews.length
              }}</span>
          </button>
        </nav>
      </div>

      <!-- Portfolio Content -->
      <div *ngIf="activeTab === 'portfolio'" class="mt-8 animate-fade-in">
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
          <div *ngFor="let item of worker.portfolio"
            class="group relative bg-surface-light dark:bg-surface-dark rounded-xl shadow-md overflow-hidden aspect-w-16 aspect-h-12 border border-white/5">
            <img [src]="item.imageUrl" [alt]="item.title"
              class="w-full h-64 object-cover transition-transform duration-500 group-hover:scale-110">
            <div
              class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex flex-col justify-end p-6">
              <h3
                class="text-lg font-bold text-white translate-y-4 group-hover:translate-y-0 transition-transform duration-300">
                {{ item.title }}</h3>
              <p
                class="text-sm text-gray-300 mt-1 translate-y-4 group-hover:translate-y-0 transition-transform duration-300 delay-75">
                {{ item.description }}</p>
            </div>
          </div>

          <div *ngIf="worker.portfolio.length === 0" class="col-span-full py-16 text-center">
            <div
              class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-gray-100 dark:bg-gray-800 mb-4">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor" class="w-8 h-8 text-gray-400">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z" />
              </svg>
            </div>
            <p class="text-on-surface-light/60 dark:text-on-surface-dark/60">{{ 'PROFILE.NO_PORTFOLIO' | translate }}
            </p>
          </div>
        </div>
      </div>

      <!-- Reviews Content -->
      <div *ngIf="activeTab === 'reviews'" class="mt-8 animate-fade-in space-y-8">
        <div class="grid gap-6">
          <div *ngFor="let review of worker.reviews" class="bg-gray-50 dark:bg-white/5 p-6 rounded-xl">
            <div class="flex items-start gap-4">
              <img class="h-10 w-10 rounded-full object-cover ring-2 ring-white dark:ring-gray-700"
                src="https://i.pravatar.cc/150?u={{review.author.id}}" [alt]="review.author.name">
              <div class="flex-grow">
                <div class="flex justify-between items-start">
                  <div>
                    <h4 class="font-bold text-on-surface-light dark:text-on-surface-dark">{{ review.author.name }}</h4>
                    <div class="flex items-center text-yellow-500 mt-1">
                      <svg *ngFor="let i of [].constructor(review.rating)" class="w-4 h-4"
                        xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                        <path
                          d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                      </svg>
                    </div>
                  </div>
                  <span class="text-xs text-on-surface-light/40 dark:text-on-surface-dark/40">{{ review.createdAt |
                    date:'mediumDate' }}</span>
                </div>
                <p class="mt-3 text-on-surface-light/80 dark:text-on-surface-dark/80 leading-relaxed">{{ review.comment
                  }}</p>
              </div>
            </div>
          </div>
        </div>

        <div *ngIf="worker.reviews.length === 0" class="text-center py-16">
          <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-gray-100 dark:bg-gray-800 mb-4">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
              stroke="currentColor" class="w-8 h-8 text-gray-400">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="M7.5 8.25h9m-9 3H12m-6.75 3h9m-9 3h9m-9 3h9M3.75 21a3 3 0 0 0 3-3V6a3 3 0 0 0-3-3H3.75" />
            </svg>
          </div>
          <p class="text-on-surface-light/60 dark:text-on-surface-dark/60">{{ 'PROFILE.NO_REVIEWS' | translate }}</p>
        </div>

        <!-- Review Form -->
        <div *ngIf="canReview" class="mt-12 pt-8 border-t border-gray-200 dark:border-gray-700">
          <h3 class="text-2xl font-bold text-on-surface-light dark:text-on-surface-dark mb-6">{{ 'PROFILE.LEAVE_REVIEW'
            | translate }}</h3>
          <form (ngSubmit)="submitReview()" class="bg-gray-50 dark:bg-white/5 p-6 rounded-2xl space-y-6">
            <div>
              <label for="rating"
                class="block text-sm font-medium text-on-surface-light/80 dark:text-on-surface-dark/80 mb-2">{{
                'PROFILE.RATING' | translate }}</label>
              <div class="flex flex-wrap gap-4">
                <div class="flex items-center gap-2">
                  <input type="radio" [(ngModel)]="newReview.rating" name="rating" [value]="5" id="r5"
                    class="text-primary focus:ring-primary cursor-pointer">
                  <label for="r5" class="text-sm cursor-pointer">{{ 'PROFILE.RATING_STARS.5' | translate }}</label>
                </div>
                <div class="flex items-center gap-2">
                  <input type="radio" [(ngModel)]="newReview.rating" name="rating" [value]="4" id="r4"
                    class="text-primary focus:ring-primary cursor-pointer">
                  <label for="r4" class="text-sm cursor-pointer">{{ 'PROFILE.RATING_STARS.4' | translate }}</label>
                </div>
                <div class="flex items-center gap-2">
                  <input type="radio" [(ngModel)]="newReview.rating" name="rating" [value]="3" id="r3"
                    class="text-primary focus:ring-primary cursor-pointer">
                  <label for="r3" class="text-sm cursor-pointer">{{ 'PROFILE.RATING_STARS.3' | translate }}</label>
                </div>
                <div class="flex items-center gap-2">
                  <input type="radio" [(ngModel)]="newReview.rating" name="rating" [value]="2" id="r2"
                    class="text-primary focus:ring-primary cursor-pointer">
                  <label for="r2" class="text-sm cursor-pointer">{{ 'PROFILE.RATING_STARS.2' | translate }}</label>
                </div>
                <div class="flex items-center gap-2">
                  <input type="radio" [(ngModel)]="newReview.rating" name="rating" [value]="1" id="r1"
                    class="text-primary focus:ring-primary cursor-pointer">
                  <label for="r1" class="text-sm cursor-pointer">{{ 'PROFILE.RATING_STARS.1' | translate }}</label>
                </div>
              </div>
            </div>
            <div>
              <label for="comment"
                class="block text-sm font-medium text-on-surface-light/80 dark:text-on-surface-dark/80 mb-2">{{
                'PROFILE.COMMENT' | translate }}</label>
              <textarea [(ngModel)]="newReview.comment" name="comment" id="comment" rows="4"
                class="w-full bg-white dark:bg-black/20 rounded-xl border-gray-200 dark:border-gray-700 focus:ring-primary focus:border-primary"
                placeholder="Share your experience..."></textarea>
            </div>
            <div class="flex justify-end">
              <button [disabled]="submittingReview" type="submit"
                class="px-6 py-3 bg-primary hover:bg-primary-dark text-white font-bold rounded-xl shadow-lg shadow-primary/30 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2">
                <svg *ngIf="submittingReview" class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg"
                  fill="none" viewBox="0 0 24 24">
                  <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                  <path class="opacity-75" fill="currentColor"
                    d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                  </path>
                </svg>
                {{ submittingReview ? ('PROFILE.SUBMITTING' | translate) : ('PROFILE.SUBMIT_REVIEW' | translate) }}
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>