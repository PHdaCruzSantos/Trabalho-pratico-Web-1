<nav
  class="fixed w-full top-0 z-50 transition-all duration-300 border-b border-white/10"
  [ngClass]="{'bg-background-light/80 dark:bg-background-dark/80 backdrop-blur-md shadow-lg': isScrolled, 'bg-transparent': !isScrolled}"
>
  <div class="container mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center h-16">
      <!-- Logo -->
      <div class="flex-shrink-0 flex items-center">
        <a routerLink="/" class="flex items-center gap-2 group">
          <div class="relative flex items-center justify-center w-10 h-10 rounded-xl bg-gradient-to-br from-primary to-secondary text-white shadow-lg group-hover:shadow-primary/50 transition-all duration-300">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
              <path fill-rule="evenodd" d="M9.315 7.584C12.195 3.883 16.695 1.5 21.75 1.5a.75.75 0 01.75.75c0 5.056-2.383 9.555-6.084 12.436h.001c-3.7 2.881-8.199 5.264-13.254 5.264a.75.75 0 01-.75-.75c0-5.055 2.383-9.555 6.084-12.436z" clip-rule="evenodd" />
              <path d="M4.786 2.812a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5a.75.75 0 01.75-.75zM2.636 5.093a.75.75 0 011.06 0l1.06 1.06a.75.75 0 01-1.06 1.06l-1.06-1.06a.75.75 0 010-1.06zm1.06 4.413a.75.75 0 010 1.06l-1.06 1.06a.75.75 0 01-1.06-1.06l1.06-1.06a.75.75 0 011.06 0z" />
            </svg>
          </div>
          <span class="font-display font-bold text-xl tracking-tight text-on-background-light dark:text-on-background-dark group-hover:text-primary transition-colors">
            Service<span class="text-primary">Hub</span>
          </span>
        </a>
      </div>

      <!-- Desktop Menu -->
      <div class="hidden md:flex items-center space-x-8">
        <a
          routerLink="/"
          routerLinkActive="text-primary font-semibold"
          [routerLinkActiveOptions]="{ exact: true }"
          class="text-sm font-medium text-on-surface-light dark:text-on-surface-dark hover:text-primary transition-colors"
        >
          {{ 'NAV.HOME' | translate }}
        </a>
        
        <!-- Language Switcher -->
        <div class="flex items-center gap-2 text-on-surface-light dark:text-on-surface-dark">
          <button 
            (click)="switchLanguage('pt-BR')" 
            [class.font-bold]="translate.currentLang === 'pt-BR'" 
            [class.text-primary]="translate.currentLang === 'pt-BR'"
            class="text-xs hover:text-primary transition-colors uppercase"
          >
            ðŸ‡§ðŸ‡· PT
          </button>
          <span class="text-on-surface-light/30 dark:text-on-surface-dark/30 text-xs">|</span>
          <button 
            (click)="switchLanguage('en-US')" 
            [class.font-bold]="translate.currentLang === 'en-US'"
            [class.text-primary]="translate.currentLang === 'en-US'"
            class="text-xs hover:text-primary transition-colors uppercase"
          >
            EN ðŸ‡ºðŸ‡¸
          </button>
        </div>

        <!-- Theme Toggle -->
        <button
          (click)="toggleTheme()"
          class="p-2 rounded-full hover:bg-surface-light dark:hover:bg-surface-dark text-on-surface-light dark:text-on-surface-dark transition-colors"
          [title]="'NAV.THEME.' + (currentTheme === 'dark' ? 'LIGHT' : 'DARK') | translate"
        >
          <svg *ngIf="currentTheme === 'light'" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
          </svg>
          <svg *ngIf="currentTheme === 'dark'" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
          </svg>
          <svg *ngIf="currentTheme === 'system'" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
          </svg>
        </button>

        <!-- Auth Buttons -->
        <ng-container *ngIf="!currentUser">
          <div class="flex items-center gap-4">
            <button
              (click)="openAuthModal('login')"
              class="text-sm font-medium text-on-surface-light dark:text-on-surface-dark hover:text-primary transition-colors"
            >
              {{ 'NAV.LOGIN' | translate }}
            </button>
            <button
              (click)="openAuthModal('register')"
              class="px-4 py-2 text-sm font-medium text-white bg-primary hover:bg-primary-dark rounded-lg shadow-lg shadow-primary/30 hover:shadow-primary/50 transition-all duration-300 transform hover:-translate-y-0.5"
            >
              {{ 'NAV.SIGNUP' | translate }}
            </button>
          </div>
        </ng-container>

        <!-- User Dropdown -->
        <ng-container *ngIf="currentUser">
          <div class="relative">
            <button
              (click)="toggleDropdown()"
              class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-surface-light dark:hover:bg-surface-dark transition-colors"
            >
              <div class="w-8 h-8 rounded-full bg-gradient-to-r from-primary to-secondary flex items-center justify-center text-white font-bold text-sm">
                {{ currentUser.name.charAt(0).toUpperCase() }}
              </div>
              <span class="text-sm font-medium text-on-surface-light dark:text-on-surface-dark">{{ currentUser.name }}</span>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4 text-gray-400 transition-transform duration-200" [class.rotate-180]="isDropdownOpen">
                <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd" />
              </svg>
            </button>

            <!-- Dropdown Menu -->
            <div
              *ngIf="isDropdownOpen"
              class="absolute right-0 mt-2 w-56 origin-top-right bg-surface-light dark:bg-surface-dark rounded-xl shadow-xl border border-white/10 ring-1 ring-black ring-opacity-5 focus:outline-none animate-fade-in"
            >
              <div class="p-1">
                <a
                  *ngIf="currentUser.role === 'TRABALHADOR'"
                  routerLink="/dashboard"
                  class="flex items-center gap-2 px-4 py-2 text-sm text-on-surface-light dark:text-on-surface-dark hover:bg-primary/10 hover:text-primary rounded-lg transition-colors"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18a2.25 2.25 0 01-2.25 2.25H6A2.25 2.25 0 013.75 18v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25a2.25 2.25 0 01-2.25-2.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z" />
                  </svg>
                  {{ 'NAV.DASHBOARD' | translate }}
                </a>
                <a
                  *ngIf="currentUser.role === 'TRABALHADOR' && currentUser.workerProfile"
                  [routerLink]="['/worker', currentUser.workerProfile.id]"
                  class="flex items-center gap-2 px-4 py-2 text-sm text-on-surface-light dark:text-on-surface-dark hover:bg-primary/10 hover:text-primary rounded-lg transition-colors"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z" />
                  </svg>
                  {{ 'NAV.PROFILE' | translate }}
                </a>
                <a
                  *ngIf="currentUser.role === 'CONTRATANTE'"
                  routerLink="/dashboard/client-profile"
                  class="flex items-center gap-2 px-4 py-2 text-sm text-on-surface-light dark:text-on-surface-dark hover:bg-primary/10 hover:text-primary rounded-lg transition-colors"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z" />
                  </svg>
                  {{ 'NAV.PROFILE' | translate }}
                </a>
                <button
                  (click)="logout()"
                  class="w-full flex items-center gap-2 px-4 py-2 text-sm text-error hover:bg-error/10 rounded-lg transition-colors text-left"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15M12 9l-3 3m0 0 3 3m-3-3h12.75" />
                  </svg>
                  {{ 'NAV.LOGOUT' | translate }}
                </button>
              </div>
            </div>
          </div>
        </ng-container>
      </div>
    </div>
  </div>
</nav>
